{% extends "layout.html" %}

{% block title %}
    My Decks
{% endblock %}

{% block main %}
<div class="container max-w-4xl mx-auto px-4 py-6 space-y-6">

  <!-- ðŸ”¹ Registro de mazos -->
  <form id="register-deck-form" class="space-y-4">

    <!-- Deck Type -->
    <div>
      <label for="deck_type" class="block text-sm font-medium text-gray-700 mb-1">Deck Type</label>
      <select id="deck_type" required
        class="w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
        <option value="" disabled selected>Loading deck types...</option>
      </select>
    </div>

    <!-- Conditional Fields (autocomplete inputs) -->
    <div id="commander_field" class="hidden relative">
      <input autocomplete="off" id="commander_name" placeholder="Commander Name" type="text"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
      <ul id="commander-suggestions" class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg"></ul>
    </div>

    <div id="partnerField" class="hidden relative">
      <input autocomplete="off" id="partner_name" placeholder="Who is the Partner?" type="text"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
      <ul id="partner-suggestions" class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg"></ul>
    </div>

    <div id="friendsForeverField" class="hidden relative">
      <input autocomplete="off" id="friendsForever_name" placeholder="Who is the BFF?" type="text"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
      <ul id="friendsForever-suggestions" class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg"></ul>
    </div>

    <div id="doctorCompanionField" class="hidden relative">
      <input autocomplete="off" id="doctorCompanion_name" placeholder="Who is the Doctor's Companion?" type="text"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
      <ul id="doctorCompanion-suggestions" class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg"></ul>
    </div>

    <div id="timeLordDoctorField" class="hidden relative">
      <input autocomplete="off" id="timeLordDoctor_name" placeholder="Who is the Doctor?" type="text"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
      <ul id="timeLordDoctor-suggestions" class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg"></ul>
    </div>

    <div id="backgroundField" class="hidden relative">
      <input autocomplete="off" id="background_name" placeholder="Choose your background" type="text"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
      <ul id="background-suggestions" class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg"></ul>
    </div>

    <!-- Deck Name -->
    <div>
      <label for="deck_name" class="block text-sm font-medium text-gray-700 mb-1">Deck Name</label>
      <input id="deck_name" type="text" autocomplete="off" autofocus placeholder="Enter a deck name"
        class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm text-gray-800 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50" />
    </div>

    <!-- Register Button -->
    <button type="submit"
      class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg shadow-sm transition">
      Register Deck
    </button>
  </form>

  <!-- ðŸ”¹ SecciÃ³n de decks -->
  <div class="space-y-2">
    <h2 class="text-xl font-semibold text-gray-800">My Decks</h2>

    <div>
      <label for="sort_decks" class="block text-sm font-medium text-gray-700 mb-1">Sort by</label>
      <select id="sort_decks"
        class="w-full md:w-60 rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
        <option value="last_match" selected>Last Match</option>
        <option value="matches">Matches</option>
        <option value="name">Deck name</option>
        <option value="winrate">Winrate</option>
      </select>
    </div>
  </div>

  <div id="decks-container" class="grid gap-4 md:grid-cols-2 xl:grid-cols-3"></div>
</div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
    <script src="/static/js/deck_types.js"></script>
    <script type="module" src="{{ url_for('static', filename='js/deckForm.js') }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/api/user_decks.js') }}"></script>
    <script src="/static/js/registerDeck.js"></script>
    <script type="module" src="{{ url_for('static', filename='js/ui/decks/sort_decks.js') }}"></script>
{% endblock %}